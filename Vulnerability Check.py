import telnetlib; import re
from termcolor import colored
import colorama; import os

colorama.init()

REQUEST = "HEAD / HTTP/2.0"


def vulnerableCheck():
    net = telnetlib.Telnet(URL, port=port)
    net.write(REQUEST.encode('utf-8') + b"\n\n")
    read = net.read_all()
    return(str(read, encoding="utf-8"))


if __name__ == '__main__':
    URL = input("Enter URL to check: ")
    if URL.lower().startswith("http://"):
        URL = URL[7:]
    if (URL[-1] == "/"):
        URL = URL[:-1]
    port = int(input("Enter port (Default = 80): ") or 80)
    try:
        response = vulnerableCheck()
    except:
        if URL.lower().startswith("https"):
            print(colored(f"{URL}: (INVALID - HTTPS)", "yellow"))
        else:
            print(colored(f"{URL}: (INVALID) - BROKEN", "yellow"))
        print("\nPress Enter to exit.")
        input()
        os._exit(0)
    print("\n" + response)

    serverType = re.findall("Server: (.+)\\r", response)
    if serverType[0].lower().startswith("apache"):
        print(colored(f"Server type: {serverType[0]} (VULNERABLE)", "red"))
    else:
        print(colored(f"Server type: {serverType[0]} (SECURE)", "green"))

    print("\nPress Enter to exit.")
    input()
